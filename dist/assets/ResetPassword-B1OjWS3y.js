import{j as e,b as s}from"./index-CKLEMzqw.js";import{u as r,f as a,r as t}from"./router-DLm9MmqM.js";import{L as o,E as d,a as l}from"./lock-Cy8JwuvR.js";import{x as n}from"./firebase-C2GiP1il.js";import"./react-vendor-BQK9_sJn.js";const i=()=>{const i=r(),[c]=a(),[m,u]=t.useState({password:"",confirmPassword:""}),[x,w]=t.useState(!1),[p,f]=t.useState(!1),[b,g]=t.useState({}),[h,y]=t.useState(!1),[j,N]=t.useState(""),[k,v]=t.useState(""),P=c.get("oobCode");t.useEffect((()=>{P||N("Invalid or missing reset code. Please use the link from your email.")}),[P]);const S=e=>{const{name:s,value:r}=e.target;u((e=>({...e,[s]:r}))),b[s]&&g((e=>({...e,[s]:""}))),N(""),v("")};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Create New Password"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Enter your new password below"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8 border border-gray-100 dark:border-gray-700",children:[j&&e.jsx("p",{className:"mb-4 text-sm text-red-600 dark:text-red-400",children:j}),k&&e.jsx("p",{className:"mb-4 text-sm text-green-600 dark:text-green-400",children:k}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault();const r=(()=>{const e={};return m.password?m.password.length<8?e.password="Password must be at least 8 characters":/(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/.test(m.password)||(e.password="Password must contain uppercase, lowercase, and number"):e.password="Password is required",m.confirmPassword?m.password!==m.confirmPassword&&(e.confirmPassword="Passwords do not match"):e.confirmPassword="Please confirm your password",e})();if(Object.keys(r).length>0)g(r);else if(P){y(!0);try{await n(s,P,m.password),v("Password updated successfully! Redirecting to login..."),setTimeout((()=>{i("/login",{state:{message:"Password reset successful. Please sign in."}})}),2e3)}catch(a){N(a.message||"Failed to reset password. Please try again.")}finally{y(!1)}}else N("Invalid reset code. Please request a new reset link.")},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(o,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:x?"text":"password",name:"password",value:m.password,onChange:S,className:"w-full pl-10 pr-12 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 dark:bg-gray-700 dark:border-gray-600 dark:text-white "+(b.password?"border-red-500":"border-gray-300"),placeholder:"Enter new password"}),e.jsx("button",{type:"button",onClick:()=>w(!x),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:x?e.jsx(d,{className:"w-5 h-5"}):e.jsx(l,{className:"w-5 h-5"})})]}),b.password&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:b.password})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(o,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:p?"text":"password",name:"confirmPassword",value:m.confirmPassword,onChange:S,className:"w-full pl-10 pr-12 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 dark:bg-gray-700 dark:border-gray-600 dark:text-white "+(b.confirmPassword?"border-red-500":"border-gray-300"),placeholder:"Confirm new password"}),e.jsx("button",{type:"button",onClick:()=>f(!p),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:p?e.jsx(d,{className:"w-5 h-5"}):e.jsx(l,{className:"w-5 h-5"})})]}),b.confirmPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:b.confirmPassword})]}),e.jsx("button",{type:"submit",disabled:h,className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white py-3 rounded-xl font-semibold hover:from-blue-700 hover:to-blue-600 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transform hover:scale-[1.02] transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:h?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Updating..."]}):"Set New Password"})]})]})]})})};export{i as default};
